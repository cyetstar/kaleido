import{d as T,a as _,b as n,o as C,l as R,w as o,k as c,f as t,N as E,P as x,G as j,u as F,r as G,y as L,L as M,c as H,t as q,e as z,g as k,O as N}from"./index-8V0LDlr9.js";import{s as I}from"./sysDictTypeApi-jTA_ZecI.js";import{s as J,b as Q,c as W,d as X,e as S,f as Y}from"./sysDictApi-CcooC7wW.js";const Z=T({__name:"sysDictCreateBatch",emits:["save-complete"],setup(g,{expose:v,emit:y}){const f=y;let p=_(),s=_({batchContent:"",dictType:""}),e;const h=m=>{e=m,p.value.reset(),p.value.show()},b=async()=>{try{const m=[];s.value.batchContent.split(/\n/).forEach(d=>{const[a,i]=d.split(/\s+/);a&&i&&m.push({value:a,label:i,dictType:e})}),await J(m)&&(x.success("操作成功"),f("save-complete"),p.value.hide())}catch{}};return v({create:h}),(m,l)=>{const r=n("h-input"),d=n("h-col"),a=n("h-form-modal");return C(),R(a,{ref_key:"formRef",ref:p,"label-col":{span:6},form:c(s),"onUpdate:form":l[1]||(l[1]=i=>E(s)?s.value=i:s=i),title:"批量新增",onSubmit:b},{default:o(()=>[t(d,{span:24},{default:o(()=>[t(r,{"text-area":"",required:"",name:"batchContent",value:c(s).batchContent,"onUpdate:value":l[0]||(l[0]=i=>c(s).batchContent=i),rows:5,placeholder:"每行一对项值、项名，项值、项名之间用空格间隔"},null,8,["value"])]),_:1})]),_:1},8,["form"])}}}),ee=T({__name:"sysDictForm",emits:["save-complete"],setup(g,{expose:v,emit:y}){const f=y;let p=_("create"),s=_(),e=_({id:"",label:"",value:"",sort:"",dictType:""});const h=l=>{p.value="create",e.value={id:"",label:"",value:"",sort:"",dictType:l},s.value.reset(),s.value.show()},b=async l=>{p.value="update",s.value.reset(),e.value=await Q(l),s.value.show()},m=async()=>{try{p.value==="create"?await W(e.value)&&(x.success("操作成功"),f("save-complete"),s.value.hide()):p.value==="update"&&await X(e.value)&&(x.success("操作成功"),f("save-complete"),s.value.hide())}catch{}};return v({create:h,update:b}),(l,r)=>{const d=n("h-input"),a=n("h-col"),i=n("h-form-modal");return C(),R(i,{ref_key:"formRef",ref:s,"label-col":{span:6},form:c(e),"onUpdate:form":r[3]||(r[3]=u=>E(e)?e.value=u:e=u),title:c(p)==="create"?"新增字典项":"编辑字典项",onSubmit:m},{default:o(()=>[t(a,{span:24},{default:o(()=>[t(d,{required:"",label:"字典项名",name:"label",value:c(e).label,"onUpdate:value":r[0]||(r[0]=u=>c(e).label=u)},null,8,["value"])]),_:1}),t(a,{span:24},{default:o(()=>[t(d,{required:"",label:"字典项值",name:"value",value:c(e).value,"onUpdate:value":r[1]||(r[1]=u=>c(e).value=u)},null,8,["value"])]),_:1}),t(a,{span:24},{default:o(()=>[t(d,{required:"",label:"顺序号",name:"sort",value:c(e).sort,"onUpdate:value":r[2]||(r[2]=u=>c(e).sort=u)},null,8,["value"])]),_:1})]),_:1},8,["form","title"])}}}),te={class:"h-page-section"},ae={style:{color:"#333"}},se={style:{color:"#333"}},ce=T({__name:"sysDictTypeView",setup(g){let v=_(),y=_(),f=_();const p=j();F();let s=_(p.query.id||""),e=G({name:"",type:""});L(()=>{h()});const h=async()=>{s&&I(s.value).then(a=>{Object.assign(e,a),S({dictType:e.type}).then(i=>{f.value=i.records})})},b=a=>{v.value.update(a)},m=async a=>{Y(typeof a=="string"?[a]:a).then(u=>{u&&(x.success("操作成功！"),S({dictType:e.type}).then(D=>{f.value=D.records}))})},l=()=>{v.value.create(e.type)},r=()=>{y.value.create(e.type)},d=()=>{S({dictType:e.type}).then(a=>{f.value=a.records})};return _([]),(a,i)=>{const u=n("h-module-title"),D=n("h-col"),K=n("a-row"),B=n("h-button"),U=n("a-space"),w=n("a-table-column"),O=n("h-button-delete"),P=n("a-table"),A=M("permissKey");return C(),H("section",te,[t(u,{title:"基本信息"}),t(K,null,{default:o(()=>[t(D,{span:8},{default:o(()=>[z("span",ae,"字典名称："+q(c(e).name),1)]),_:1}),t(D,{span:8},{default:o(()=>[z("span",se,"字典类型："+q(c(e).type),1)]),_:1})]),_:1}),t(u,{title:"字典项",class:"mt-40px"}),t(U,{class:"h-btn-space"},{default:o(()=>[t(B,{type:"primary",onClick:r},{default:o(()=>[k("批量新增")]),_:1}),t(B,{type:"primary",onClick:l},{default:o(()=>[k("新增")]),_:1})]),_:1}),t(P,{bordered:"",size:"small","row-key":"id",pagination:!1,dataSource:c(f)},{default:o(()=>[t(w,{title:"字典项名","data-index":"label"}),t(w,{title:"字典项值","data-index":"value"}),t(w,{title:"顺序","data-index":"sort"}),t(w,{title:"操作",key:"action"},{default:o(({record:V})=>[t(U,{size:0},{default:o(()=>[N((C(),R(B,{type:"primary",link:"",size:"small",onClick:$=>b(V.id)},{default:o(()=>[k("编辑 ")]),_:2},1032,["onClick"])),[[A,"sysDict:update"]]),N((C(),R(O,{link:"",size:"small",onDelete:$=>m(V.id)},{default:o(()=>[k("删除 ")]),_:2},1032,["onDelete"])),[[A,"sysDict:delete"]])]),_:2},1024)]),_:1})]),_:1},8,["dataSource"]),t(ee,{ref_key:"formRef",ref:v,onSaveComplete:d},null,512),t(Z,{ref_key:"formBatchRef",ref:y,onSaveComplete:d},null,512)])}}});export{ce as default};
