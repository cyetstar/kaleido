import{a as c,b as d,o as p,c as U,f as a,w as n,k as l,F as g,a9 as V,l as _,n as h,g as D,e as O,N as P,P as k}from"./index-8V0LDlr9.js";import{e as j,i as E,j as $}from"./tvshowSeasonApi-yL39YQBd.js";import{_ as q}from"./actorForm-JIEKGh_E.js";import{M as z}from"./MinusOutlined-ga10JiA-.js";const X={__name:"tvshowSeasonForm",emits:["save-complete"],setup(G,{expose:I,emit:T}){const y=T;let v=c("create"),m=c(),w=c(),e=c({id:"",showId:"",title:"",summary:"",seasonIndex:"",thumb:"",art:"",addedAt:"",updatedAt:""});const R=()=>{v.value="create",m.value.reset(),m.value.show()},A=async u=>{v.value="update",m.value.reset(),e.value=await j({id:u}),e.value.directorList.length>0&&(e.value.directorList=e.value.directorList.map(t=>t.id)),e.value.writerList.length>0&&(e.value.writerList=e.value.writerList.map(t=>t.id)),m.value.show()},C=u=>{u===0?e.value.actorList.push({id:"",playRole:""}):e.value.actorList.splice(u,1)},S=()=>{w.value.create()},x=async()=>{try{v.value==="create"?await E(e.value)&&(k.success("操作成功"),y("save-complete"),m.value.hide()):v.value==="update"&&await $(e.value)&&(k.success("操作成功"),y("save-complete"),m.value.hide())}catch{}};return I({create:R,update:A}),(u,t)=>{const r=d("h-input"),s=d("h-col"),F=d("h-select"),L=d("a-tab-pane"),b=d("k-select-actor"),B=d("a-row"),K=d("a-tabs"),M=d("a-col"),N=d("h-form-modal");return p(),U(g,null,[a(N,{ref_key:"refForm",ref:m,"label-col":{span:4},width:"1000px",form:l(e),"onUpdate:form":t[13]||(t[13]=o=>P(e)?e.value=o:e=o),title:"单季",onSubmit:x},{default:n(()=>[a(M,{span:24},{default:n(()=>[a(K,{activeKey:u.activeKey,"onUpdate:activeKey":t[12]||(t[12]=o=>u.activeKey=o),"tab-position":"left"},{default:n(()=>[a(L,{key:"basic",tab:"基本"},{default:n(()=>[a(s,{span:24},{default:n(()=>[a(r,{label:"标题",value:l(e).title,"onUpdate:value":t[0]||(t[0]=o=>l(e).title=o),name:"title"},null,8,["value"])]),_:1}),a(s,{span:24},{default:n(()=>[a(r,{label:"原标题",value:l(e).originalTitle,"onUpdate:value":t[1]||(t[1]=o=>l(e).originalTitle=o),name:"originalTitle"},null,8,["value"])]),_:1}),a(s,{span:24},{default:n(()=>[a(r,{label:"排序名",value:l(e).sortTitle,"onUpdate:value":t[2]||(t[2]=o=>l(e).sortTitle=o),name:"sortTitle"},null,8,["value"])]),_:1}),a(s,{span:24},{default:n(()=>[a(r,{label:"简介","text-area":"",rows:"4",value:l(e).summary,"onUpdate:value":t[3]||(t[3]=o=>l(e).summary=o),name:"summary"},null,8,["value"])]),_:1}),a(s,{span:24},{default:n(()=>[a(r,{label:"年份",value:l(e).year,"onUpdate:value":t[4]||(t[4]=o=>l(e).year=o),name:"year"},null,8,["value"])]),_:1}),a(s,{span:24},{default:n(()=>[a(r,{label:"评分",value:l(e).rating,"onUpdate:value":t[5]||(t[5]=o=>l(e).rating=o),name:"rating"},null,8,["value"])]),_:1}),a(s,{span:24},{default:n(()=>[a(F,{label:"评级",value:l(e).contentRating,"onUpdate:value":t[6]||(t[6]=o=>l(e).contentRating=o),"dict-type":"tvshowContentRating",name:"contentRating"},null,8,["value"])]),_:1}),a(s,{span:24},{default:n(()=>[a(r,{label:"IMDb编号",value:l(e).imdbId,"onUpdate:value":t[7]||(t[7]=o=>l(e).imdbId=o),name:"imdbId"},null,8,["value"])]),_:1}),a(s,{span:24},{default:n(()=>[a(r,{label:"豆瓣编号",value:l(e).doubanId,"onUpdate:value":t[8]||(t[8]=o=>l(e).doubanId=o),name:"doubanId"},null,8,["value"])]),_:1}),a(s,{span:24},{default:n(()=>[a(r,{label:"TMDB编号",value:l(e).tmdbId,"onUpdate:value":t[9]||(t[9]=o=>l(e).tmdbId=o),name:"tmdbId"},null,8,["value"])]),_:1})]),_:1}),a(L,{key:"authors",tab:"演职表"},{default:n(()=>[a(s,{span:24},{default:n(()=>[a(b,{value:l(e).directorList,"onUpdate:value":t[10]||(t[10]=o=>l(e).directorList=o),mode:"multiple",name:"directorIdList",label:"导演"},null,8,["value"])]),_:1}),a(s,{span:24},{default:n(()=>[a(b,{value:l(e).writerList,"onUpdate:value":t[11]||(t[11]=o=>l(e).writerList=o),mode:"multiple",name:"writerList",label:"编剧",maxTagCount:1},null,8,["value"])]),_:1}),a(s,{span:24},{default:n(()=>[(p(!0),U(g,null,h(l(e).actorList,(o,i)=>(p(),_(B,{key:i},{default:n(()=>[a(s,{span:12},{default:n(()=>[a(b,{labelCol:{span:8},value:l(e).actorList[i].id,"onUpdate:value":f=>l(e).actorList[i].id=f,name:"form.actorList["+i+"].id",label:"主演"},null,8,["value","onUpdate:value","name"])]),_:2},1024),a(s,{span:12},{default:n(()=>[a(r,{value:l(e).actorList[i].playRole,"onUpdate:value":f=>l(e).actorList[i].playRole=f,name:"form.actorList["+i+"].playRole",label:"饰",search:"",onSearch:f=>C(i)},{enterButton:n(()=>[i===0?(p(),_(l(V),{key:0})):(p(),_(l(z),{key:1}))]),_:2},1032,["value","onUpdate:value","name","onSearch"])]),_:2},1024)]),_:2},1024))),128))]),_:1}),a(s,{span:24,offset:"4"},{default:n(()=>[D("找不到？"),O("a",{onClick:S},"新增演职员")]),_:1})]),_:1})]),_:1},8,["activeKey"])]),_:1})]),_:1},8,["form"]),a(q,{ref_key:"refActorForm",ref:w},null,512)],64)}}};export{X as _};
