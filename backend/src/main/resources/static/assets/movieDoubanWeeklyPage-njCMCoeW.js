import{a as R,b as W}from"./movieDoubanWeeklyApi-qp031ZAG.js";import{_ as V,u as A,v as F,a as p,y as L,Z as j,$,b as s,o as i,c,e as n,f as o,w as r,g as q,t as d,k as b,a1 as U,a3 as Z,F as k,n as y,P as S,C as H}from"./index-8V0LDlr9.js";const J={class:"k-page-section"},K={class:"k-search-form"},O={class:"flex justify-between items-center"},Q={class:"flex justify-end items-center mt-4 mb-2"},X={key:0},Y={key:1,class:"grid grid-cols-24 gap-6"},ee={class:"absolute top-0 left-0 m-2px"},oe={class:"grid grid-rows-4 grid-flow-col gap-x-6"},te={class:"row-span-1"},ae={__name:"movieDoubanWeeklyPage",setup(se){const w=A(),v=F(),_=p(),g=p(!0),u=p({}),l=p({records:[],pageNumber:0,pageSize:100});L(()=>{C()}),j(()=>{_.value.scrollTop=v.getScrollTop("movieCollection")}),$((t,a,m)=>{v.setScrollTop(_.value.scrollTop,"movieCollection"),m()});const x=()=>{W().then(t=>{t?S.success("同步成功"):S.error("同步发生错误")})},C=()=>{g.value=!0;const t={pageNumber:l.value.pageNumber+1,pageSize:l.value.pageSize,searchCount:!0,...u.value};R(t).then(a=>{g.value=!1,l.value.records.push(...a.records),l.value.pageNumber=a.pageNumber,l.value.pageSize=a.pageSize,l.value.total=a.total})},N=t=>{w.push({path:"/movie/movieBasic/view",query:{id:t}})};return(t,a)=>{const m=s("h-input"),D=s("a-form"),I=s("h-button"),E=s("a-space"),T=s("a-empty"),z=s("k-plex-image"),f=s("k-logo-link"),B=s("a-card-meta"),M=s("a-card"),P=s("a-badge-ribbon");return i(),c("section",J,[n("div",K,[n("div",O,[o(D,{model:u.value},{default:r(()=>[o(m,{value:u.value.keyword,"onUpdate:value":a[0]||(a[0]=e=>u.value.keyword=e),placeholder:"关键字",search:"",enterButton:"",onSearch:t.onSearch},null,8,["value","onSearch"])]),_:1},8,["model"]),o(E,null,{default:r(()=>[o(I,{onClick:x},{default:r(()=>[q("同步口碑榜")]),_:1})]),_:1})]),n("div",Q,[n("div",null,"总记录数: "+d(l.value.total),1)])]),n("section",{ref_key:"refScrollGrid",ref:_,onScroll:a[1]||(a[1]=(...e)=>t.onScrollGrid&&t.onScrollGrid(...e))},[b(U)(l.value.records)?(i(),c("div",X,[o(T,{image:b(Z).PRESENTED_IMAGE_SIMPLE},null,8,["image"])])):(i(),c("div",Y,[(i(!0),c(k,null,y(l.value.records,e=>(i(),c("div",{key:e.id,class:"col-span-12"},[o(P,{text:"#"+e.top,color:e.status==="1"?"red":""},{default:r(()=>[o(M,{class:"k-card k-card-inline",bordered:!0},{cover:r(()=>[o(z,{preview:!1,"plex-thumb":e.thumb,class:H(["h-poster",e.movieId?"cursor-pointer":null]),onClick:h=>e.movieId?N(e.movieId):null},null,8,["plex-thumb","class","onClick"]),n("div",ee,[o(f,{type:"plex",id:e.movieId,width:20,class:"mr-1"},null,8,["id"]),o(f,{type:"douban",id:e.doubanId,width:20},null,8,["id"])])]),default:r(()=>[o(B,{title:e.title+" ("+e.year+")"},{description:r(()=>[n("div",null,d(e.originalTitle),1),n("div",oe,[(i(!0),c(k,null,y(e.listingDetailMap,(h,G)=>(i(),c("div",te,d(G)+" ～ #"+d(h),1))),256))])]),_:2},1032,["title"])]),_:2},1024)]),_:2},1032,["text","color"])]))),128))]))],544)])}}},ie=V(ae,[["__scopeId","data-v-7f4f4ceb"]]);export{ie as default};
