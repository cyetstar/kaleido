import{a as c,b as n,o as h,c as x,f as t,w as l,a5 as D,g as _,e as u,t as g,a2 as C,k as S,z as I,l as E,F as P,P as q}from"./index-8V0LDlr9.js";import{_ as G,e as H,f as J}from"./comicSeriesFileManage-joA7-t-O.js";const L={class:"flex gap-2"},O=["href"],Q=["src"],W=["href"],X={key:0,class:"text-muted"},Y={class:"text-muted"},ae={__name:"comicSeriesSearchInfo",emits:["match-success"],setup(Z,{expose:F,emit:$}){const z=$,b=c(),d=c(),p=c(),r=c(),v=c([]),s=c({source:"bgm",keyword:"",matchType:"path"}),M=[{text:"bgm",value:"bgm"},{text:"bgm(v0)",value:"bgm_v0"}];let i={};const B=(a,o)=>{i=a,v.value=[],r.value=!0,s.value.matchType=o,o==="path"?(d.value=i.name,s.value.keyword=i.name.replaceAll("[","").replaceAll("]","").trim()):(d.value=i.title,s.value.keyword=i.title)},k=()=>{p.value=!0,H(s.value).then(a=>{v.value=a,p.value=!1})},N=a=>{b.value.show(a)},y=a=>{J({...i,...a,...s.value}).then(()=>{q.success("匹配成功"),r.value=!1,z("match-success")})},w=a=>{if(a.bgmId&&a.bgmId===i.bgmId)return"bg-highlight"};return F({show:B,addRowColor:w}),(a,o)=>{const V=n("h-radio"),j=n("h-input"),m=n("h-button"),f=n("a-table-column"),U=n("k-logo-link"),A=n("a-space"),K=n("a-table"),R=n("a-modal");return h(),x(P,null,[t(R,{ref:"formRef",visible:r.value,"onUpdate:visible":o[2]||(o[2]=e=>r.value=e),title:`匹配【${d.value}】信息`,width:"960px",footer:null},{default:l(()=>[u("div",L,[t(V,{value:s.value.source,"onUpdate:value":o[0]||(o[0]=e=>s.value.source=e),button:"",name:"source",columns:M},null,8,["value"]),t(j,{class:"flex-1",placeholder:"",value:s.value.keyword,"onUpdate:value":o[1]||(o[1]=e=>s.value.keyword=e),name:"keyword",onKeyup:D(k,["enter"])},null,8,["value"]),t(m,{onClick:k},{default:l(()=>[_("搜索")]),_:1}),t(m,{onClick:y},{default:l(()=>[_("无法匹配")]),_:1})]),t(K,{size:"small","data-source":v.value,loading:p.value,"row-class-name":w,pagination:!1,class:"mt-3"},{default:l(()=>[t(f,{title:"封面",align:"center",width:"150px"},{default:l(({record:e})=>[u("a",{href:`https://bgm.tv/subject/${e.bgmId}`,target:"_blank",class:"flex justify-center"},[u("img",{src:e.cover,width:80,referrerpolicy:"no-referrer"},null,8,Q)],8,O)]),_:1}),t(f,{title:"漫画信息"},{default:l(({record:e})=>[u("p",null,[u("a",{href:`https://bgm.tv/subject/${e.bgmId}`,target:"_blank"},g(e.series),9,W),t(U,{type:"komga",width:20,id:e.existId,class:"ml-3"},null,8,["id"])]),S(C)(e.originalSeries)?(h(),x("p",X,g(e.originalSeries),1)):I("",!0),u("div",Y,g(e.year),1)]),_:1}),t(f,{title:"操作",align:"center",width:"150px"},{default:l(({record:e})=>[t(A,{size:0},{default:l(()=>[S(C)(e.existId)?(h(),E(m,{key:0,type:"primary",size:"small",link:"",onClick:T=>N(e.existId)},{default:l(()=>[_("查看文件 ")]),_:2},1032,["onClick"])):I("",!0),t(m,{type:"primary",size:"small",link:"",onClick:T=>y(e)},{default:l(()=>[_("匹配 ")]),_:2},1032,["onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data-source","loading"])]),_:1},8,["visible","title"]),t(G,{ref_key:"refComicSeriesFileManage",ref:b},null,512)],64)}}};export{ae as _};
