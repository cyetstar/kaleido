import{a as L,b as c,o as s,l as g,w as n,g as U,f as e,P as q,_ as Q,k as a,F as _,a9 as W,n as b,c as r,N as X,G as Y,u as Z,x as j,a2 as T,y as ee,e as d,a4 as te,z as y,t as k,aa as ae}from"./index-8V0LDlr9.js";import{b as le,c as H,d as se,e as ne}from"./tvshowShowApi--6lP2oKh.js";import{a as oe}from"./tvshowSeasonApi-yL39YQBd.js";import{h as ue}from"./movieBasicApi-t3o0u2-x.js";import{M as ie}from"./MinusOutlined-ga10JiA-.js";const re={__name:"tvshowShowFileManage",emits:["match-success"],setup(O,{expose:V,emit:R}){const l=L([]),w=L();let m=null,t=null;const C=I=>{m=I,le({id:m}).then(x=>{t=x,w.value.show(t)})},A=I=>{ue({id:m,path:t,file:I.file}).then(x=>{x?w.value.load():q.error("上传失败")})};return V({show:C}),(I,x)=>{const f=c("h-button"),o=c("a-upload"),h=c("k-file-modal");return s(),g(h,{ref_key:"refFileModal",ref:w},{footer:n(()=>[e(o,{"file-list":l.value,"onUpdate:fileList":x[0]||(x[0]=p=>l.value=p),name:"file",showUploadList:!1,"custom-request":A},{default:n(()=>[e(f,{plain:"",type:"primary"},{default:n(()=>[U("上传海报")]),_:1})]),_:1},8,["file-list"])]),_:1},512)}}},de={__name:"tvshowShowForm",emits:["save-complete"],setup(O,{expose:V,emit:R}){const l=R;let w=L("create"),m=L(),t=L({id:"",title:"",originalTitle:"",studio:"",contentRating:"",summary:"",year:"",originallyAvailableAt:"",rating:"",thumb:"",art:"",totalSeasons:"",addedAt:"",updatedAt:""});const C=()=>{w.value="create",m.value.reset(),m.value.show()},A=async f=>{w.value="update",m.value.reset(),t.value=await H({id:f}),m.value.show()},I=async()=>{try{w.value==="create"?await se(t.value)&&(q.success("操作成功"),l("save-complete"),m.value.hide()):w.value==="update"&&(t.value.akaList=t.value.akaList.filter(o=>o!==""),await ne(t.value)&&(q.success("操作成功"),l("save-complete"),m.value.hide()))}catch{}},x=f=>{f===0?t.value.akaList.push(""):t.value.akaList.splice(f,1)};return V({create:C,update:A}),(f,o)=>{const h=c("h-input"),p=c("h-col"),v=c("h-select"),M=c("a-tab-pane"),$=c("a-tabs"),P=c("a-col"),D=c("h-form-modal");return s(),g(D,{ref_key:"refForm",ref:m,"label-col":{span:4},width:"1000px",form:a(t),"onUpdate:form":o[15]||(o[15]=u=>X(t)?t.value=u:t=u),title:"剧集",onSubmit:I},{default:n(()=>[e(P,{span:24},{default:n(()=>[e($,{activeKey:f.activeKey,"onUpdate:activeKey":o[14]||(o[14]=u=>f.activeKey=u),"tab-position":"left"},{default:n(()=>[e(M,{key:"basic",tab:"基本"},{default:n(()=>[e(p,{span:24},{default:n(()=>[e(h,{label:"标题",value:a(t).title,"onUpdate:value":o[0]||(o[0]=u=>a(t).title=u),name:"title"},null,8,["value"])]),_:1}),e(p,{span:24},{default:n(()=>[e(h,{label:"原标题",value:a(t).originalTitle,"onUpdate:value":o[1]||(o[1]=u=>a(t).originalTitle=u),name:"originalTitle"},null,8,["value"])]),_:1}),e(p,{span:24},{default:n(()=>[e(h,{label:"排序名",value:a(t).sortTitle,"onUpdate:value":o[2]||(o[2]=u=>a(t).sortTitle=u),name:"sortTitle"},null,8,["value"])]),_:1}),e(p,{span:24},{default:n(()=>[e(h,{label:"简介","text-area":"",rows:"4",value:a(t).summary,"onUpdate:value":o[3]||(o[3]=u=>a(t).summary=u),name:"summary"},null,8,["value"])]),_:1}),e(p,{span:24},{default:n(()=>[e(h,{label:"年份",value:a(t).year,"onUpdate:value":o[4]||(o[4]=u=>a(t).year=u),name:"year"},null,8,["value"])]),_:1}),e(p,{span:24},{default:n(()=>[e(h,{label:"评分",value:a(t).rating,"onUpdate:value":o[5]||(o[5]=u=>a(t).rating=u),name:"rating"},null,8,["value"])]),_:1}),e(p,{span:24},{default:n(()=>[e(v,{label:"评级",value:a(t).contentRating,"onUpdate:value":o[6]||(o[6]=u=>a(t).contentRating=u),"dict-type":"tvshowContentRating",name:"contentRating"},null,8,["value"])]),_:1}),e(p,{span:24},{default:n(()=>[e(h,{label:"IMDb编号",value:a(t).imdbId,"onUpdate:value":o[7]||(o[7]=u=>a(t).imdbId=u),name:"imdbId"},null,8,["value"])]),_:1}),e(p,{span:24},{default:n(()=>[e(h,{label:"豆瓣编号",value:a(t).doubanId,"onUpdate:value":o[8]||(o[8]=u=>a(t).doubanId=u),name:"doubanId"},null,8,["value"])]),_:1}),e(p,{span:24},{default:n(()=>[e(h,{label:"TMDB编号",value:a(t).tmdbId,"onUpdate:value":o[9]||(o[9]=u=>a(t).tmdbId=u),name:"tmdbId"},null,8,["value"])]),_:1})]),_:1}),e(M,{key:"tags",tab:"标签"},{default:n(()=>[e(p,{span:24},{default:n(()=>[e(v,{mode:"multiple",label:"国家地区",value:a(t).countryList,"onUpdate:value":o[10]||(o[10]=u=>a(t).countryList=u),dictType:"Country",name:"countryList"},null,8,["value"])]),_:1}),e(p,{span:24},{default:n(()=>[e(v,{mode:"multiple",label:"语言",value:a(t).languageList,"onUpdate:value":o[11]||(o[11]=u=>a(t).languageList=u),dictType:"Language",name:"languageList"},null,8,["value"])]),_:1}),e(p,{span:24},{default:n(()=>[e(v,{mode:"multiple",label:"类型",value:a(t).genreList,"onUpdate:value":o[12]||(o[12]=u=>a(t).genreList=u),dictType:"Genre",name:"genreList"},null,8,["value"])]),_:1}),e(p,{span:24},{default:n(()=>[e(v,{mode:"tags",label:"标签",value:a(t).tagList,"onUpdate:value":o[13]||(o[13]=u=>a(t).tagList=u),name:"tagList"},null,8,["value"])]),_:1})]),_:1}),e(M,{key:"akas",tab:"别名"},{default:n(()=>[e(p,{span:24},{default:n(()=>[(s(!0),r(_,null,b(a(t).akaList,(u,S)=>(s(),g(h,{key:S,label:"别名",value:a(t).akaList[S],"onUpdate:value":K=>a(t).akaList[S]=K,name:"aka"+S,search:"",onSearch:K=>x(S),allowClear:!1},{enterButton:n(()=>[S===0?(s(),g(a(W),{key:0})):(s(),g(a(ie),{key:1}))]),_:2},1032,["value","onUpdate:value","name","onSearch"]))),128))]),_:1})]),_:1})]),_:1},8,["activeKey"])]),_:1})]),_:1},8,["form"])}}},ce=Q(de,[["__scopeId","data-v-a97f83f0"]]),pe={class:"k-view-section"},ve={class:"flex"},_e={class:"flex-1 ml-8"},me={key:0},fe={class:"flex items-center"},he={key:0,class:"mr-2"},ye={key:0},ke={key:1,class:"flex"},ge=d("span",{class:"mr-2"},"导演:",-1),we={class:"flex-1"},be={key:0,class:"px-2"},Le=["onClick"],xe={key:2,class:"flex"},Se=d("span",{class:"mr-2"},"编剧:",-1),Te={class:"flex-1"},Ue={key:0,class:"px-2"},Ce=["onClick"],Ie={key:3,class:"flex"},Fe=d("span",{class:"mr-2"},"又名:",-1),Me={class:"flex-1"},Ae={key:0,class:"px-2"},Ve={key:4,class:"flex"},Be=d("span",{class:"mr-2"},"制片方:",-1),Re={class:"flex-1"},$e={class:"flex"},Pe=d("span",{class:"mr-2"},"更新于:",-1),Ke={class:"flex-1"},Ne={key:0},De={class:"grid grid-cols-24 gap-6"},qe={key:1},Oe={class:"grid grid-cols-24 gap-6"},Je={__name:"tvshowShowView",setup(O){const V=Y(),R=Z(),l=L({}),w=L([]);L();const m=L(),t=L(),C=V.query.id,A=L({showId:C,force:!0}),I=j(()=>l.value.rating/2),x=j(()=>T(l.value.actorList)&&l.value.actorList.length>8?l.value.actorList.slice(0,8):l.value.actorList),f=async()=>{H({id:C}).then(v=>{l.value=v}),oe({pageSize:1e3,orderBy:"ASC:season_index",showId:C}).then(({records:v})=>{w.value=v})},o=v=>{R.push({path:"/tvshow/tvshowSeason/view",query:{id:v,title:l.value.title}})},h=()=>{t.value.update(C)},p=()=>{m.value.show(C)};return ee(()=>{f()}),(v,M)=>{const $=c("k-action-button"),P=c("h-button"),D=c("a-space"),u=c("a-page-header"),S=c("k-thumb-image"),K=c("a-rate"),B=c("a-tag"),N=c("k-logo-link"),z=c("h-module-title"),G=c("a-card-meta"),E=c("a-card");return s(),r(_,null,[d("section",pe,[e(u,{title:l.value.title,onBack:M[0]||(M[0]=()=>v.$router.go(-1))},{backIcon:n(()=>[e(a(te))]),extra:n(()=>[e(D,null,{default:n(()=>[e($,{action:"tvshowSync","ok-text":"同步Plex","cancel-text":"取消同步",form:A.value},null,8,["form"]),e($,{action:"tvshowMatchInfo","ok-text":"自动抓取","cancel-text":"取消抓取",form:A.value},null,8,["form"]),e(P,{onClick:h},{default:n(()=>[U("编辑")]),_:1}),e(P,{onClick:p},{default:n(()=>[U("文件管理")]),_:1})]),_:1})]),_:1},8,["title"]),d("section",ve,[d("div",null,[l.value.id?(s(),g(S,{key:0,class:"h-poster",type:"TvshowShow",style:{width:"250px"},id:l.value.id},null,8,["id"])):y("",!0)]),d("div",_e,[d("p",null,[U(k(l.value.originalTitle)+" ",1),a(T)(l.value.year)?(s(),r("span",me,"("+k(l.value.year)+")",1)):y("",!0)]),d("p",fe,[a(T)(l.value.rating)?(s(),r("span",he,k(l.value.rating)+" 分",1)):y("",!0),e(K,{value:I.value,"onUpdate:value":M[1]||(M[1]=i=>I.value=i),disabled:"","allow-half":""},null,8,["value"])]),d("p",null,[l.value.contentRating?(s(),g(B,{key:0},{default:n(()=>[U(k(l.value.contentRating),1)]),_:1})):y("",!0),(s(!0),r(_,null,b(l.value.countryList,i=>(s(),g(B,{key:i},{default:n(()=>[U(k(i),1)]),_:2},1024))),128)),(s(!0),r(_,null,b(l.value.genreList,i=>(s(),g(B,{key:i},{default:n(()=>[U(k(i),1)]),_:2},1024))),128)),(s(!0),r(_,null,b(l.value.languageList,i=>(s(),g(B,{key:i},{default:n(()=>[U(k(i),1)]),_:2},1024))),128)),(s(!0),r(_,null,b(l.value.tagList,i=>(s(),g(B,{key:i},{default:n(()=>[U(k(i),1)]),_:2},1024))),128))]),a(T)(l.value.summaryList)?(s(),r("p",ye,[(s(!0),r(_,null,b(l.value.summaryList,(i,F)=>(s(),r("p",{key:F},k(i),1))),128))])):y("",!0),a(T)(l.value.directorList)?(s(),r("p",ke,[ge,d("span",we,[(s(!0),r(_,null,b(l.value.directorList,(i,F)=>(s(),r(_,null,[F!==0?(s(),r("span",be,"/")):y("",!0),d("a",{onClick:J=>v.onViewArtist(i)},k(i.name),9,Le)],64))),256))])])):y("",!0),a(T)(l.value.writerList)?(s(),r("p",xe,[Se,d("span",Te,[(s(!0),r(_,null,b(l.value.writerList,(i,F)=>(s(),r(_,null,[F!==0?(s(),r("span",Ue,"/")):y("",!0),d("a",{onClick:J=>v.onViewArtist(i)},k(i.name),9,Ce)],64))),256))])])):y("",!0),a(T)(l.value.akaList)?(s(),r("p",Ie,[Fe,d("span",Me,[(s(!0),r(_,null,b(l.value.akaList,(i,F)=>(s(),r(_,null,[F!==0?(s(),r("span",Ae,"/")):y("",!0),U(" "+k(i),1)],64))),256))])])):y("",!0),a(T)(l.value.studio)?(s(),r("p",Ve,[Be,d("span",Re,k(l.value.studio),1)])):y("",!0),d("p",$e,[Pe,d("span",Ke,k(a(ae)(l.value.updatedAt)),1)]),d("p",null,[e(N,{type:"plex",id:l.value.id,class:"mr-3"},null,8,["id"]),e(N,{type:"imdb",id:l.value.imdbId,class:"mr-3"},null,8,["id"]),e(N,{type:"tmdbtv",id:l.value.tmdbId,class:"mr-3"},null,8,["id"]),e(N,{type:"douban",id:l.value.doubanId,class:"mr-3"},null,8,["id"])])])]),a(T)(l.value.actorList)?(s(),r("section",Ne,[e(z,{title:"主演"}),d("div",De,[(s(!0),r(_,null,b(x.value,i=>(s(),g(E,{key:i.id,class:"k-card col-span-3",bordered:!1},{cover:n(()=>[e(S,{class:"h-thumb",preview:!1,url:i.thumb,onClick:F=>v.onViewArtist(i)},null,8,["url","onClick"])]),default:n(()=>[e(G,{title:i.name,description:i.playRole},null,8,["title","description"])]),_:2},1024))),128))])])):y("",!0),a(T)(w.value)?(s(),r("section",qe,[e(z,{title:"单季"}),d("div",Oe,[(s(!0),r(_,null,b(w.value,i=>(s(),g(E,{key:i.id,class:"k-card col-span-3",bordered:!1},{cover:n(()=>[e(S,{class:"h-poster",type:"TvshowSeason",preview:!1,id:i.id,onClick:F=>o(i.id)},null,8,["id","onClick"])]),default:n(()=>[e(G,{title:i.title},null,8,["title"])]),_:2},1024))),128))])])):y("",!0)]),e(re,{ref_key:"refTvshowShowFileManage",ref:m},null,512),e(ce,{ref_key:"refTvshowShowForm",ref:t},null,512)],64)}}};export{Je as default};
